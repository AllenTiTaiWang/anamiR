{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Introduction to anamiR\"\nauthor: \"anamiR Developers\"\ndate: \"`r Sys.Date()`\"\noutput:\n  BiocStyle::html_document:\n  toc: true\nvignette: >\n  %\\VignetteIndexEntry{Introduction to anamiR}\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteEncoding{UTF-8}\n---\nThis document guides one through all available functions of the `anamiR` package. Package anamiR aims to find potential miRNA-target gene interactions from both miRNA and mRNA expression data.\n\nTraditional miRNA analysis method is to use online databases to predict miRNA-target gene interactions. However, the false positive rate of prediction is so high that interactions are not reliable. To address this issue, anamiR integrates the whole expression analysis with expression data into workflow, including normalization, differential expression, correlation and then databases intersection, to find more reliable interactions.\n\n\n## Installation\n\nanamiR is on Bioconductor and can be installed following standard installation procedure.\n\n```{r, eval = FALSE}\nsource(\"http://www.bioconductor.org/biocLite.R\")\nbiocLite(\"anamiR\")\n```\n\nTo use,\n\n```{r}\nlibrary(anamiR)\n```\n\n\n## General Workflow\n\nThe general workflow can be summarized as follows,\n\n![](pics/workflow.png)\n\nBasically there are six steps, corresponding to six R functions, to complete the whole analysis:\n\n1. Normalize expression data\n2. Find differential expreesion miRNAs and genes\n3. Convert miRNA annotation to the latest version\n4. Calculate the correlation coefficient between each miRNA and gene\n5. Intersect with prediction and validation of miRNA- target gene interactions databases\n6. Functional analysis with interested genes\n\n\n## Data Source\n\nAs shown in the workflow, not only samples of *paired* miRNA and mRNA expression\ndata ,but  phenotypical information of miRNA and mRNA are also required for the\nanalysis. Since anamiR reads data in expression matrices, data sources are\nplatform and technology agnostic. particularly, expression data from microarray\nor next generation sequencing are all acceptable for anamiR. However, this also\nindicates the raw data should be pre-processd to the expression matrices before\nusing anamiR.\n\n### mRNA expression\n\nColumns for samples. Rows for genes\n\n```raw\nGENE  SmapleA   SamplB ...\nA     0.1       0.2\nB    -0.5      -0.3\nC     0.4       0.1\n```\n\n### miRNA expression\n\nColumns for samples. Rows for miRNAs\n\n```raw\nmiRNA  SampleA  SampleB ...\nA         0.1     0.5\nB        -0.5     2.1\nC         0.4     0.3\n```\n\n### phenotype data\n\nCloumns for samples. Rows for feature name, including two groups, multiple groups, continuous data.\n\n```raw\nFeature  SampleA  SampleB  SampleC ...\ngroupA   A        B        A\ngroupB   A        B        C\ngroupC   121.22   120.34   123.33\n```\n\n## Usage Example\n\nNow, we show an example using internal data for anamiR workflow.\n\n### Example Data Source\n\nTo demonstrate the usage of the `anamiR` package, the package  contains 30 paired\nmiRNA and mRNA breast cancer samples, which are selected from 101 miRNA samples and\n114 mRNA samples from GSE19536. As for phenotype data (hybridization information),\nthere are three types of information in it, including two-groups, multi-groups,\ncontinuous data.\n\nThe mRNA data was conducted by Agilent-014850 Whole Human Genome Microarray 4x44K\nG4112F (Probe Name version) platform and the miRNA data was generated from\nAgilent-019118 Human miRNA Microarray 2.0 G4470B (miRNA ID version).\n\n### Format of Input Data\n\nFirst of all, load the internal data and check the format.\n\n```{r}\ndata(mrna)\ndata(mirna)\ndata(pheno.mirna)\ndata(pheno.mrna)\n```\n\nBasically, the format of input data should be the same as the internal data.\nFor mRNA expression data should be like,\n\n```{r}\nmrna[1:5,1:5]\n```\n\nAs for miRNA expression data,\n\n```{r}\nmirna[1:5,1:5]\n```\n\nAnd the phenotype data,\n\n```{r}\npheno.mrna[1:3,1:3]\n```\n\nActually, the phenotype data of miRNA and mRNA share the same contents,but\nin this case, we still make it in two data to prevent users from being\nconfused about it.\n\n### Normalization (Optional)\n\nSecondly, we normalize data.\n(If you use the normalized data, you can skip this step.)\n\n```{r, eval = FALSE}\nse <- normalization(data = mirna, method = \"quantile\")\n```\n\nFor this function, there are three methods provided, including `quntile`,\n`rank.invariant`, `normal`. For more detail, Please refer to their\ndocumentation.\n\nNote that internal data have already been normalized, here is only for\ndemonstration.\n\n### SummarizedExperiment class\n\nBefore entering the main workflow, we should put our data and phenotype \ninformation into `SummarizedExperiment` class first, which you can get \nmore information from \\code{\\link[SummarizedExperiment]{SummarizedExperiment}}.\n\n```{r}\n\nmrna_se <- SummarizedExperiment(\n    assays = SimpleList(counts=mrna),\n    colData = pheno.mrna)\n\nmirna_se <- SummarizedExperiment(\n    assays = SimpleList(counts=mirna),\n    colData = pheno.mirna)\n\n```\n\n### Differential Expression Analysis\n\nThird, we will find differential expression genes and miRNAs.\nThere are three statitical methods in this function. here, we use\n`t.test` for demonstration.\n\n```{r}\nmrna_d <- differExp_discrete(se = mrna_se,\n    class = \"ER\", method = \"t.test\",\n    t_test.var = FALSE, log2 = FALSE,\n    p_value.cutoff = 0.05,  foldchange = 0.5\n)\n\nmirna_d <- differExp_discrete(se = mirna_se,\n   class = \"ER\", method = \"t.test\",\n   t_test.var = FALSE, log2 = FALSE,\n   p_value.cutoff = 0.05,  foldchange = 0.5\n)\n```\n\nThis function will delete genes and miRNAs (rows), which do not\ndifferential express, and add another three columns represent\nfold change (log2), p-value, adjusted p-value.\n\nTake differential expressed mRNA data for instance,\n\n```{r}\nnc <- ncol(mrna_d)\nmrna_d[1:5, (nc-4):nc]\n```\n\n### Convert miRNA Annotation (Optional)\n\nBefore using collected databases for intersection with potential\nmiRNA-target gene interactions, we have to make sure all miRNA\nare in the latest annotation version (miRBase 21). If not, we\ncould use this function  to do it.\n\n```{r}\nmirna_21 <- miR_converter(data = mirna_d, remove_old = TRUE,\n    original_version = 17, latest_version = 21)\n```\n\nNow, we can compare these two data,\n\n```{r}\n# Before\nhead(row.names(mirna_d))\n# After\nhead(row.names(mirna_21))\n```\n\nNote that user must put the right original version into parameter,\nbecause it is an important information for function to convert\nannotation.\n\n### Correlation Analysis\n\nTo find potential miRNA-target gene interactions, we should\ncombine the information in two differential expressed data,\nwhich we obtained from `differExp_discrete`.\n\n```{r}\ncor <- negative_cor(mrna_data = mrna_d, mirna_data = mirna_21,\n    method = \"pearson\", cut.off = -0.5)\n```\n\nFor output,\n\n```{r}\nhead(cor)\n```\n\nAs the showing `list`, each row is a potential interaction,\nand only the row that correlation coefficient < cut.off would\nbe kept in list.\n\nNote that in our assumption, miRNAs negatively regulate\nexpression of their target genes, that is, cut.off basically\nshould be negative decimal.\n\n### Heat map (optional)\n\nThere is a function for user to see the heatmaps about \nthe miRNA-target gene interactions remaining in the \ncorrelation analysis table.\n\n```{r}\nheat_vis(cor, mrna_d, mirna_21)\n```\n\n\n### Intersect with Databases\n\nAfter correlation analysis, we have some potential interactions,\nand then using `database_support` helps us to get information\nthat whether there are databases predict or validate  these\ninteractions.\n\n```{r}\nsup <- database_support(cor_data = cor,\n    org = \"hsa\", Sum.cutoff = 3)\n```\n\nFrom output, column `Sum` tells us the total hits by 8 predict\ndatabases and column `Validate` tells us if this interaction\nhave been validated.\n\n```{r}\nhead(sup)\n```\nNote that we have 8 predict databases (DIANA microT CDS, EIMMo,\nMicrocosm, miRDB, miRanda, PITA, rna22, TargetScan) and 2\nvalidate databases (miRecords, miRTarBase).\n\n### Functional Analysis\n\nThe last, after finding reliable miRNA-target gene interactions,\nwe are also interested in pathways, which may be enriched by\nthese genes.\n\n```{r}\npath <- enrichment(data_support = sup, org = \"hsa\", per_time = 1000)\n```\n\nNote that for parameter per_time, we only choose 1000 times, \nbecause it is for demonstration here. Default is 5000 times.\n\nThe output from this data not only shows P-Value generated by\nhypergeometric test, but Empirical P-Value, which means the\nvalue of average permutation test in each pathway.\n\n```{r}\nhead(path)\n```\n\n## Other Functions\n\n### Multiple-Groups Data\n\nAs for the data, which classify samples into more than two\ngroups, anamiR provides function `multi_Differ`. User can\nget more information about this function by refering to\nits documentation.\n\n### Continuous Data\n\nThe data with continuous phenotype feature are also supported,\n`differExp_continuous` contains linear regression model, which\ncan fit the continuous data series. User can get more\ninformation about this function by refering to its documentation.\n\n\n",
    "created" : 1481776806496.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3756596355",
    "id" : "D74E5931",
    "lastKnownWriteTime" : 1481776527,
    "last_content_update" : 1481776527,
    "path" : "~/svn-pkg/anamiR/vignettes/IntroductionToanamiR.Rmd",
    "project_path" : "vignettes/IntroductionToanamiR.Rmd",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}